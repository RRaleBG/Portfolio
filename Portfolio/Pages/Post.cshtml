@page "{slug}"
@model Portfolio.Pages.PostModel
@using System.Text.Encodings.Web
@{
    ViewData["Title"] = Model.Item?.Title ?? "Post";
    int wordCount = Model.Item?.Content?.Split(' ', StringSplitOptions.RemoveEmptyEntries).Length ?? 0;
    int readingTime = (int)Math.Ceiling(wordCount / 200.0);
}

@if (Model.Item == null)
{
    <div class="alert alert-warning">Post not found.</div>
}
else
{
    <article>
        <h2>@HtmlEncoder.Default.Encode(Model.Item.Title)</h2>
        <div class="text-muted">@Model.Item.PublishedAt.ToString("yyyy-MM-dd")</div>
        <div class="mb-2 text-info">Estimated reading time: @readingTime min</div>
        <div class="mt-3 animated-text">@Model.Item.Content</div>
    </article>
}

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var el = document.querySelector('.animated-text');
            if (el) {
                el.style.opacity = 0;
                el.style.transition = "opacity 1.5s";
                setTimeout(function () {
                    el.style.opacity = 1;
                }, 300);
            }
        });
    </script>
}
<style>
    .animated-text {
        opacity: 0;
    }
</style>
